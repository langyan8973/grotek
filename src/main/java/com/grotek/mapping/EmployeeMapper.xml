<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.grotek.dao.EmployeeMapper" >
  <resultMap id="BaseResultMap" type="com.grotek.pojo.Employee" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 10 14:06:55 CST 2016.
    -->
    <id column="id" property="id" jdbcType="VARCHAR" />
    <result column="fullname" property="fullname" jdbcType="VARCHAR" />
    <result column="code" property="code" jdbcType="VARCHAR" />
    <result column="sex" property="sex" jdbcType="VARCHAR" />
    <result column="address" property="address" jdbcType="VARCHAR" />
    <result column="mobile" property="mobile" jdbcType="VARCHAR" />
    <result column="postcode" property="postcode" jdbcType="VARCHAR" />
    <result column="phone" property="phone" jdbcType="VARCHAR" />
    <result column="superior" property="superior" jdbcType="VARCHAR" />
    <result column="sname" property="sname" jdbcType="VARCHAR" />
    <result column="headimg" property="headimg" jdbcType="VARCHAR" />
    <result column="password" property="password" jdbcType="VARCHAR" />
    <result column="regform" property="regform" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="INTEGER" />
    <!-- 一对一的关系 -->  
    <!-- property: 指的是属性的值, javaType：指的是元素的类型 -->  
    <association property="position" javaType="com.grotek.pojo.PositionDic">  
        <id column="pid" property="id" jdbcType="INTEGER" />
	    <result column="pname" property="name" jdbcType="VARCHAR" />
	    <result column="pobjective" property="objective" jdbcType="VARCHAR" />
	    <result column="pamortization" property="amortization" jdbcType="DOUBLE" />
	    <result column="psalary" property="salary" jdbcType="DOUBLE" />
	    <result column="ptravel_allow" property="travelAllow" jdbcType="DOUBLE" />
	    <result column="pmobile_allow" property="mobileAllow" jdbcType="DOUBLE" />
	    <result column="pcosthour" property="costhour" jdbcType="DOUBLE" />
	    <result column="pdescription" property="description" jdbcType="VARCHAR" />
	    <result column="pdate" property="date" jdbcType="TIMESTAMP" />
	    <result column="pstatus" property="status" jdbcType="INTEGER" />  
    </association>
    <!-- property: 指的是属性的值, javaType：指的是元素的类型 -->  
    <association property="dept" javaType="com.grotek.pojo.DepartmentDic">  
        <id column="did" property="id" jdbcType="INTEGER" />
	    <result column="dname" property="name" jdbcType="VARCHAR" />
	    <result column="dcode" property="code" jdbcType="VARCHAR" />
	    <result column="dstatus" property="status" jdbcType="INTEGER" />
    </association>
    
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 10 14:06:55 CST 2016.
    -->
    id, fullname, code, sex, address, mobile, postcode, phone, position, superior, dept, 
    headimg, password, regform, status,sname
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 10 14:06:55 CST 2016.
    -->
    select 
    t.*,
    p.id as pid,p.name as pname,p.objective as pobjective,p.amortization as pamortization,p.salary as psalary,p.travel_allow as travel_allow,p.mobile_allow as pmobile_allow,p.description as description,p.date as pdate,p.status as status,p.costhour as pcosthour,
    d.id as did,d.name as dname,d.code as dcode,d.status as dstatus
    from employee t left outer join position_dic p on t.position = p.id left outer join department_dic d on t.dept = d.id
    where t.status=0 and t.id = #{id,jdbcType=VARCHAR}
  </select>
  
  <select id="getByMobile" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 10 14:06:55 CST 2016.
    -->
    select 
    t.*,
    p.id as pid,p.name as pname,p.objective as pobjective,p.amortization as pamortization,p.salary as psalary,p.travel_allow as travel_allow,p.mobile_allow as pmobile_allow,p.description as description,p.date as pdate,p.status as status,p.costhour as pcosthour,
    d.id as did,d.name as dname,d.code as dcode,d.status as dstatus
    from employee t left outer join position_dic p on t.position = p.id left outer join department_dic d on t.dept = d.id
    where t.status=0 and t.mobile = #{mobile,jdbcType=VARCHAR} order by code asc
  </select>
  
  <select id="findEmployee" resultMap="BaseResultMap">
    
    select 
    t.*,
    p.id as pid,p.name as pname,p.objective as pobjective,p.amortization as pamortization,p.salary as psalary,p.travel_allow as travel_allow,p.mobile_allow as pmobile_allow,p.description as description,p.date as pdate,p.status as status,p.costhour as pcosthour,
    d.id as did,d.name as dname,d.code as dcode,d.status as dstatus
    from employee t left outer join position_dic p on t.position = p.id left outer join department_dic d on t.dept = d.id
    where  fullname like "%"#{key,jdbcType=VARCHAR}"%" and t.status=0 order by code asc
    <if test="pageable.offset >= 0 and pageable.pageSize > 0" >  
	  limit ${pageable.offset}, ${pageable.pageSize}  
	</if>  
  </select>
  
  <select id="getEmployees" resultMap="BaseResultMap">
    
    select 
    t.*,
    p.id as pid,p.name as pname,p.objective as pobjective,p.amortization as pamortization,p.salary as psalary,p.travel_allow as travel_allow,p.mobile_allow as pmobile_allow,p.description as description,p.date as pdate,p.status as status,p.costhour as pcosthour,
    d.id as did,d.name as dname,d.code as dcode,d.status as dstatus
    from employee t left outer join position_dic p on t.position = p.id left outer join department_dic d on t.dept = d.id
    where t.status=0 order by code asc
    <if test="offset >= 0 and pageSize > 0" >  
	  limit ${offset}, ${pageSize}  
	</if>
  </select>
  
  <select id="searchCount" parameterType="java.lang.String" resultType="int">    
    select 
    count(*) 
    from employee 
    where fullname like "%"#{key,jdbcType=VARCHAR}"%"  and status=0
  </select>
  
  <select id="allCount" resultType="int">    
    select 
    count(*) 
    from employee where status=0
  </select>
  <select id="findMembers" resultMap="BaseResultMap">
    
    select 
    t.*,
    p.id as pid,p.name as pname,p.objective as pobjective,p.amortization as pamortization,p.salary as psalary,p.travel_allow as travel_allow,p.mobile_allow as pmobile_allow,p.description as description,p.date as pdate,p.status as status,p.costhour as pcosthour,
    d.id as did,d.name as dname,d.code as dcode,d.status as dstatus
    from employee t left outer join position_dic p on t.position = p.id left outer join department_dic d on t.dept = d.id
    where  fullname like "%"#{key,jdbcType=VARCHAR}"%" and t.superior=#{sid,jdbcType=VARCHAR} and t.status=0 order by code asc
    <if test="pageable.offset >= 0 and pageable.pageSize > 0" >  
	  limit ${pageable.offset}, ${pageable.pageSize}  
	</if>  
  </select>
  
  <select id="getMembers" resultMap="BaseResultMap">
    
    select 
    t.*,
    p.id as pid,p.name as pname,p.objective as pobjective,p.amortization as pamortization,p.salary as psalary,p.travel_allow as travel_allow,p.mobile_allow as pmobile_allow,p.description as description,p.date as pdate,p.status as status,p.costhour as pcosthour,
    d.id as did,d.name as dname,d.code as dcode,d.status as dstatus
    from employee t left outer join position_dic p on t.position = p.id left outer join department_dic d on t.dept = d.id
    where t.status=0 and t.superior=#{sid,jdbcType=VARCHAR} order by code asc
    <if test="pageable.offset >= 0 and pageable.pageSize > 0" >  
	  limit ${pageable.offset}, ${pageable.pageSize}  
	</if> 
  </select>
  
  <select id="searchCountMembers" resultType="int">    
    select 
    count(*) 
    from employee 
    where fullname like "%"#{key,jdbcType=VARCHAR}"%" and superior=#{sid,jdbcType=VARCHAR}  and status=0
  </select>
  
  <select id="allCountMembers" resultType="int">    
    select 
    count(*) 
    from employee where status=0 and superior=#{sid,jdbcType=VARCHAR}
  </select>
  <select id="checkCode" resultType="int">    
    select 
    count(*) 
    from employee 
    where status=0 and code = #{code,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 10 14:06:55 CST 2016.
    -->
    update employee
    set status = -1
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.grotek.pojo.Employee" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 10 14:06:55 CST 2016.
    -->
    insert into employee (id, fullname, code, 
      sex, address, mobile, 
      postcode, phone, position, 
      superior, dept, headimg, 
      password, regform, status,sname
      )
    values (#{id,jdbcType=VARCHAR}, #{fullname,jdbcType=VARCHAR}, #{code,jdbcType=VARCHAR}, 
      #{sex,jdbcType=VARCHAR}, #{address,jdbcType=VARCHAR}, #{mobile,jdbcType=VARCHAR}, 
      #{postcode,jdbcType=VARCHAR}, #{phone,jdbcType=VARCHAR}, #{position.id,jdbcType=INTEGER}, 
      #{superior,jdbcType=VARCHAR}, #{dept.id,jdbcType=INTEGER}, #{headimg,jdbcType=VARCHAR}, 
      #{password,jdbcType=VARCHAR}, #{regform,jdbcType=VARCHAR}, #{status,jdbcType=INTEGER}, #{sname,jdbcType=INTEGER}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.grotek.pojo.Employee" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 10 14:06:55 CST 2016.
    -->
    insert into employee
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="fullname != null" >
        fullname,
      </if>
      <if test="code != null" >
        code,
      </if>
      <if test="sex != null" >
        sex,
      </if>
      <if test="address != null" >
        address,
      </if>
      <if test="mobile != null" >
        mobile,
      </if>
      <if test="postcode != null" >
        postcode,
      </if>
      <if test="phone != null" >
        phone,
      </if>
      <if test="position != null" >
        position,
      </if>
      <if test="superior != null" >
        superior,
      </if>
      <if test="dept != null" >
        dept,
      </if>
      <if test="headimg != null" >
        headimg,
      </if>
      <if test="password != null" >
        password,
      </if>
      <if test="regform != null" >
        regform,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="sname != null" >
        sname,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="fullname != null" >
        #{fullname,jdbcType=VARCHAR},
      </if>
      <if test="code != null" >
        #{code,jdbcType=VARCHAR},
      </if>
      <if test="sex != null" >
        #{sex,jdbcType=VARCHAR},
      </if>
      <if test="address != null" >
        #{address,jdbcType=VARCHAR},
      </if>
      <if test="mobile != null" >
        #{mobile,jdbcType=VARCHAR},
      </if>
      <if test="postcode != null" >
        #{postcode,jdbcType=VARCHAR},
      </if>
      <if test="phone != null" >
        #{phone,jdbcType=VARCHAR},
      </if>
      <if test="position != null" >
        #{position.id,jdbcType=INTEGER},
      </if>
      <if test="superior != null" >
        #{superior,jdbcType=VARCHAR},
      </if>
      <if test="dept != null" >
        #{dept.id,jdbcType=INTEGER},
      </if>
      <if test="headimg != null" >
        #{headimg,jdbcType=VARCHAR},
      </if>
      <if test="password != null" >
        #{password,jdbcType=VARCHAR},
      </if>
      <if test="regform != null" >
        #{regform,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        #{status,jdbcType=INTEGER},
      </if>
      <if test="sname != null" >
        #{sname,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.grotek.pojo.Employee" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 10 14:06:55 CST 2016.
    -->
    update employee
    <set >
      <if test="fullname != null" >
        fullname = #{fullname,jdbcType=VARCHAR},
      </if>
      <if test="code != null" >
        code = #{code,jdbcType=VARCHAR},
      </if>
      <if test="sex != null" >
        sex = #{sex,jdbcType=VARCHAR},
      </if>
      <if test="address != null" >
        address = #{address,jdbcType=VARCHAR},
      </if>
      <if test="mobile != null" >
        mobile = #{mobile,jdbcType=VARCHAR},
      </if>
      <if test="postcode != null" >
        postcode = #{postcode,jdbcType=VARCHAR},
      </if>
      <if test="phone != null" >
        phone = #{phone,jdbcType=VARCHAR},
      </if>
      <if test="position != null" >
        position = #{position.id,jdbcType=INTEGER},
      </if>
      <if test="superior != null" >
        superior = #{superior,jdbcType=VARCHAR},
      </if>
      <if test="dept != null" >
        dept = #{dept.id,jdbcType=INTEGER},
      </if>
      <if test="headimg != null" >
        headimg = #{headimg,jdbcType=VARCHAR},
      </if>
      <if test="password != null" >
        password = #{password,jdbcType=VARCHAR},
      </if>
      <if test="regform != null" >
        regform = #{regform,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=INTEGER},
      </if>
      <if test="sname != null" >
        sname = #{sname,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.grotek.pojo.Employee" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jun 10 14:06:55 CST 2016.
    -->
    update employee
    set fullname = #{fullname,jdbcType=VARCHAR},
      code = #{code,jdbcType=VARCHAR},
      sex = #{sex,jdbcType=VARCHAR},
      address = #{address,jdbcType=VARCHAR},
      mobile = #{mobile,jdbcType=VARCHAR},
      postcode = #{postcode,jdbcType=VARCHAR},
      phone = #{phone,jdbcType=VARCHAR},
      position = #{position.id,jdbcType=INTEGER},
      superior = #{superior,jdbcType=VARCHAR},
      dept = #{dept.id,jdbcType=INTEGER},
      headimg = #{headimg,jdbcType=VARCHAR},
      password = #{password,jdbcType=VARCHAR},
      regform = #{regform,jdbcType=VARCHAR},
      status = #{status,jdbcType=INTEGER},
      sname = #{sname,jdbcType=VARCHAR}
    where id = #{id,jdbcType=VARCHAR}
  </update>
</mapper>